
<!DOCTYPE html>

<!-- HTML BASE DOCUMENT -->

<HTML lang="fr">
    <HEAD>
        <meta charset="utf-8">
        <title>{{!titre}}</title>
        <meta name="decription" content="Ceci est le 'template' web pour un menu de restaurant.">
        <meta name="auteur" content="Daniel-Junior Dubé et Sarah Laflamme">
        <link rel="shortcut icon" href="/src/tab.ico">
        <link rel="stylesheet" href="/src/affichage.css">
        <script type='text/javascript' src='/src/interact-1.2.5.min.js'></script>
        <script type='text/javascript' src='/src/interactApp.js'></script>
        <script type='text/javascript' src='/src/jquery-2.1.4.min.js'></script>
        <script type='text/javascript' src='/src/knockout-3.3.0.js'></script>
        <script type='text/javascript' src='/src/knockout.mapping-latest.js'></script>
    </HEAD>
        <!-- ko if: fenetre.image_fond() === "ZoneBase" -->
        <BODY data-bind="attr: { 'background': '../src/'+fenetre.image_fond.chemin_fichier() }">
        <!-- /ko -->
        <!-- ko if: zone.type() === "ZoneBase" -->
        <BODY data-bind="attr: { 'background': '../src/'+fenetre.image_fond() }">
        <!-- /ko -->
            <div class="interact-container" data-bind="foreach: { data: fenetre.zones, as: 'zone' }">
                <!-- ko if: zone.type() === "ZoneBase" -->
                <div class="zone base" data-bind="style: { 
                    left : $data.position_x + '%', 
                    top : $data.position_y + '%', 
                    width : $data.largeur + '%', 
                    height : $data.hauteur + '%'
                }">
                    <!-- ko if: zone.type_style() === "titre" -->
                    <div data-bind="text: contenu, style: {
                        fontFamily : $root.fenetre.theme.titre.police(),
                        fontSize : $root.fenetre.theme.titre.taille() + 'px',
                        color : $root.fenetre.theme.titre.couleur(),
                        background : $root.fenetre.theme.titre.couleur_fond(),
                        opacity : $root.fenetre.theme.titre.opacite_fond(),
                        bold : $root.fenetre.theme.titre.gras(),
                        fontStyle : $root.fenetre.theme.titre.gras(),
                        textDecoration : $root.fenetre.theme.titre.soulignement(),
                        borderColor :  $root.fenetre.theme.titre.bordure.couleur(),
                        borderStyle : $root.fenetre.theme.titre.bordure.style(),
                        borderWidth : $root.fenetre.theme.titre.bordure.taille()
                    }"></div>
                    <!-- /ko -->
                    <!-- ko if: zone.type_style() === "sous_titre" -->
                    <div data-bind="text: contenu, style: {
                        fontFamily : $root.fenetre.theme.sous_titre.police(),
                        fontSize : $root.fenetre.theme.sous_titre.taille() + 'px',
                        color : $root.fenetre.theme.sous_titre.couleur(),
                        background : $root.fenetre.theme.sous_titre.couleur_fond(),
                        opacity : $root.fenetre.theme.sous_titre.opacite_fond(),
                        bold : $root.fenetre.theme.sous_titre.gras(),
                        fontStyle : $root.fenetre.theme.sous_titre.gras(),
                        textDecoration : $root.fenetre.theme.sous_titre.soulignement(),
                        borderColor :  $root.fenetre.theme.sous_titre.bordure.couleur(),
                        borderStyle : $root.fenetre.theme.sous_titre.bordure.style(),
                        borderWidth : $root.fenetre.theme.sous_titre.bordure.taille()
                    }"></div>
                    <!-- /ko -->
                    <!-- ko if: zone.type_style() === "texte" -->
                    <div data-bind="text: contenu, style: {
                        fontFamily : $root.fenetre.theme.texte.police(),
                        fontSize : $root.fenetre.theme.texte.taille() + 'px',
                        color : $root.fenetre.theme.texte.couleur(),
                        background : $root.fenetre.theme.texte.couleur_fond(),
                        opacity : $root.fenetre.theme.texte.opacite_fond(),
                        bold : $root.fenetre.theme.texte.gras(),
                        fontStyle : $root.fenetre.theme.texte.gras(),
                        textDecoration : $root.fenetre.theme.texte.soulignement(),
                        borderColor :  $root.fenetre.theme.texte.bordure.couleur(),
                        borderStyle : $root.fenetre.theme.texte.bordure.style(),
                        borderWidth : $root.fenetre.theme.texte.bordure.taille()
                    }"></div>
                    <!-- /ko -->
                </div>
                <!-- /ko -->
                <!-- ko if: zone.type() === "ZoneImage" -->
                <div class="zone media" data-bind="style: { 
                    left : $data.position_x() + '%', 
                    top : $data.position_y() + '%', 
                    width : $data.largeur() + '%', 
                    height : $data.hauteur() + '%', 
                    background : 'rgb(0,0,0)' 
                }">
                    <img data-bind="attr: { 'src': '../src/'+$data.image.chemin_fichier() }">
                </div>
                <!-- /ko -->
                <!-- ko if: zone.type() === "ZoneVideo" -->
                <div class="zone media" data-bind="style: { 
                    left : $data.position_x() + '%', 
                    top : $data.position_y() + '%', 
                    width : $data.largeur() + '%', 
                    height : $data.hauteur() + '%' 
                }">
                    <video width="100%" height="100%" muted autoplay loop>
                        <source data-bind="attr: { 
                            'src': $data.video.chemin_fichier() 
                        }" type="video/mp4" />
                        Your browser does not support the video tag.
                    </video>
                </div>
                <!-- /ko -->
                <!-- ko if: zone.type() === "ZoneTable" -->
                <div class="zone" data-bind="style: { 
                    left : $data.position_x() + '%', 
                    top : $data.position_y() + '%', 
                    width : $data.largeur() + '%', 
                    height : $data.hauteur()  + '%'
                }">
                    <table data-bind="attr : {
                        fontFamily : $root.fenetre.theme.tableau.police(),
                        fontSize : $root.fenetre.theme.tableau.taille() + 'px',
                        color : $root.fenetre.theme.tableau.couleur(),
                        background : $root.fenetre.theme.tableau.couleur_fond(),
                        opacity : $root.fenetre.theme.tableau.opacite_fond(),
                        bold : $root.fenetre.theme.tableau.gras(),
                        fontStyle : $root.fenetre.theme.tableau.gras(),
                        textDecoration : $root.fenetre.theme.tableau.soulignement(),
                        borderColor :  $root.fenetre.theme.tableau.bordure.couleur(),
                        borderStyle : $root.fenetre.theme.tableau.bordure.style(),
                        borderWidth : $root.fenetre.theme.tableau.bordure.taille() + 'px'
                        }">
                        <tbody data-bind="foreach: { data: $data.lignes, as: 'ligne' }">
                            <tr data-bind="foreach: { data: $data.cellules, as: 'cellule' }, attr : {
                                fontFamily : $root.fenetre.theme.tableau_ligne.police(),
                                fontSize : $root.fenetre.theme.tableau_ligne.taille() + 'px',
                                color : $root.fenetre.theme.tableau_ligne.couleur(),
                                background : $root.fenetre.theme.tableau_ligne.couleur_fond(),
                                opacity : $root.fenetre.theme.tableau_ligne.opacite_fond(),
                                bold : $root.fenetre.theme.tableau_ligne.gras(),
                                fontStyle : $root.fenetre.theme.tableau_ligne.gras(),
                                textDecoration : $root.fenetre.theme.tableau_ligne.soulignement(),
                                borderColor :  $root.fenetre.theme.tableau_ligne.bordure.couleur(),
                                borderStyle : $root.fenetre.theme.tableau_ligne.bordure.style(),
                                borderWidth : $root.fenetre.theme.tableau_ligne.bordure.taille() + 'px'
                            }">
                                <!-- Définir le style selon les attributs json -->
                                <!-- ko if: cellule.type_style() === "tableau_titre" -->
                                <th data-bind="text: $data.contenu, style: { 
                                    fontFamily : $root.fenetre.theme.tableau_titre.police(),
                                    fontSize : $root.fenetre.theme.tableau_titre.taille() + 'px',
                                    color : $root.fenetre.theme.tableau_titre.couleur(),
                                    background : $root.fenetre.theme.tableau_titre.couleur_fond(),
                                    opacity : $root.fenetre.theme.tableau_titre.opacite_fond(),
                                    bold : $root.fenetre.theme.tableau_titre.gras(),
                                    fontStyle : $root.fenetre.theme.tableau_titre.gras(),
                                    textDecoration : $root.fenetre.theme.tableau_titre.soulignement(),
                                    borderColor :  $root.fenetre.theme.tableau_titre.bordure.couleur(),
                                    borderStyle : $root.fenetre.theme.tableau_titre.bordure.style(),
                                    borderWidth : $root.fenetre.theme.tableau_titre.bordure.taille() + 'px'
                                }"></th> 
                                <!-- /ko -->
                                <!-- ko if: cellule.type_style() === "tableau_texte" -->
                                <td data-bind="text: $data.contenu, style: { 
                                    fontFamily : $root.fenetre.theme.tableau_texte.police(),
                                    fontSize : $root.fenetre.theme.tableau_texte.taille() + 'px',
                                    color : $root.fenetre.theme.tableau_texte.couleur(),
                                    background : $root.fenetre.theme.tableau_texte.couleur_fond(),
                                    opacity : $root.fenetre.theme.tableau_texte.opacite_fond(),
                                    bold : $root.fenetre.theme.tableau_texte.gras(),
                                    fontStyle : $root.fenetre.theme.tableau_texte.gras(),
                                    textDecoration : $root.fenetre.theme.tableau_texte.soulignement(),
                                    borderColor :  $root.fenetre.theme.tableau_texte.bordure.couleur(),
                                    borderStyle : $root.fenetre.theme.tableau_texte.bordure.style(),
                                    borderWidth : $root.fenetre.theme.tableau_texte.bordure.taille() + 'px'
                                }"></td> 
                                <!-- /ko -->
  
                            </tr>
                        </tbody>
                    </table>
                </div>
                <!-- /ko -->
            </div>
    </BODY>
</html>

<script type='text/javascript' defer="defer">
    var viewModel = ko.mapping.fromJS({{!data}});
    ko.applyBindings(viewModel);

    function appliquer_modifications(fileName) {
        var unmapped = ko.mapping.toJSON(viewModel);
        console.log(unmapped);
        $.post("/g/" + fileName,
                {
                    fileName,
                    unmapped
          }
        );
    }
</script>